<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" type="text/css" href="loginpage.css" />
    <meta charset="UTF-8" />
    <script src="loginpage.js"></script>
    <title>Title</title>
  </head>
  <body>
    <div class="logoinform">
      <img src="R-ECG.gif" alt="logoinform" width="200" height="200" />
    </div>

    <div class="box"></div>

    <form action="/action_page.php" id="f1">
      <input type="email" name="email" class="email" id="email" required />
      <label class="U1" for="email">email</label>

      <input
        type="password"
        name="password"
        id="password"
        class="password"
        required
      />
      <label class="U2" for="password">Password</label>

      <button type="submit" class="login" form="f1">Login</button>

      <div class="or">or</div>
      <div class="line"></div>
      <div class="line2"></div>
    </form>

    <div class="loginGif">
      <img
        src="b43db78f64c8e26fb580bb7f00b66222.gif"
        alt="loginGif"
        id="loginGif"
        style="height: 600px; width: 650px"
      />
    </div>

    <script>
      let form = document.getElementById("f1");
      let json = {};
      form.addEventListener("submit", (event) => {
        event.preventDefault();
        console.log(event);
        form1_data = event;
        for (form_data_arr of new FormData(document.getElementById("f1"))) {
          json[form_data_arr[0]] = form_data_arr[1];
        }
        // TODO: debug print statement
        console.log(json);
        console.log(JSON.stringify(json));

        // source of wizardary: https://gist.github.com/lastguest/1fd181a9c9db0550a847
        const toUrlEncoded = (obj) =>
          Object.keys(obj)
            .map(
              (k) => encodeURIComponent(k) + "=" + encodeURIComponent(obj[k])
            )
            .join("&");
        fetch("https://rica-remastered.herokuapp.com/api/v1/common/login", {
          method: "POST",
          body: toUrlEncoded(json),
          headers: {
            "Content-Type": "application/x-www-form-urlencoded",
          },
        })
          .then((res) => res.text())
          .then((html) => console.log(html))
          .catch((err) => console.error(err));
      });
      /* TODO: ideal function needed
      backend_url("/path") ==> heroku/path; ngrok.io/path */
    </script>
  </body>
</html>
